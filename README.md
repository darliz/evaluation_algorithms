# Проект: Сравнение алгоритмов выравнивания последовательностей

Этот репозиторий содержит инструменты для оценки качества выравнивания нуклеотидных и аминокислотных последовательностей с помощью метрик SP-score, TC-score, CS-score и энтропии Шеннона, а также для визуализации результатов и статистического сравнения алгоритмов.

## Структура

```
evaluation_algorithms/         # Корень проекта
├── alignment_metrics.py       # Скрипт для одной выборки: метрики + тепловые карты
├── run_all_metrics.py         # Обёртка: запускает alignment_metrics.py для всех папок, собирает CSV и проводит статистику
├── results/                   # Сгенерированные CSV-таблицы и статистика (после запуска)
└── imgs/                      # Сгенерированные тепловые карты (после запуска)
```

## Требования

См. файл `requirements.txt`.

## Установка

1. Клонировать репозиторий:

   ```bash
   git clone <URL репозитория>
   cd evaluation_algorithms
   ```
2. Установить зависимости:

   ```bash
   pip install -r requirements.txt
   ```

## Использование

### 1. Запуск для одной папки

```bash
python alignment_metrics.py \
  -d <путь_к_папке_с_выравниваниями> \
  -t {nt,aa} \
  -o <путь_к_выходному_CSV> \
  --imgdir <путь_к_папке_для_heatmap>
```

* `-d/--directory` — папка с файлами `.fna` выравнивания.
* `-t/--type` — `nt` для нуклеотидов, `aa` для аминокислот.
* `-o/--output` — путь для сохранения сводной таблицы (CSV).
* `--imgdir` — папка для сохранения тепловых карт (будет создана автоматически).

### 2. Запуск для всех папок (обёртка)

```bash
python run_all_metrics.py
```

Скрипт автоматически:

* Находит в папке `D:\DIPLOM\ensemble` все директории с `.fna`.
* Определяет тип (`nt`/`aa`) по имени папки.
* Запускает `alignment_metrics.py` для каждой.
* Сохраняет результаты в `results/` и `imgs/`.
* Выполняет тест Kruskal–Wallis и пост-хок Dunn для всех метрик.

## Результаты

* **results/**

  * `*_scores.csv` — широкие таблицы по метрикам (алгоритмы × выборки).
  * `kruskal_*.txt` — результаты тестов Краскала–Уоллиса.
  * `posthoc_*.csv` — матрицы p-значений парных сравнений.

* **imgs/**

  * `*_SP_heatmap.png`, `*_TC_heatmap.png` — тепловые карты по выборкам.

## Лицензия

MIT © darliz
